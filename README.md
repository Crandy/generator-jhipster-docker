# generator-jhipster-docker
[![NPM version][npm-image]][npm-url] [![Build Status][travis-image]][travis-url] [![Dependency Status][daviddm-image]][daviddm-url]
> Docker JHipster module, Docker support in your JHipster application

<div align="center">
  <a href="http://jhipster.github.io">
    <img src="https://github.com/pascalgrimaud/generator-jhipster-docker/raw/master/images/logo-jhipster.png">
  </a>
  <a href="https://www.docker.com/">
    <img width=200px src="https://github.com/pascalgrimaud/generator-jhipster-docker/raw/master/images/logo-docker.png">
  </a>
</div>



## Prerequisites

This is a [JHipster](http://jhipster.github.io/) module, that is meant to be use in a JHipster application.

You have to install Docker and Docker Compose:

- [Docker](https://docs.docker.com/installation/#installation)
- [Docker Compose](https://docs.docker.com/compose/install)

All these images come from the official [Docker Hub](https://hub.docker.com/):

- [MySQL](https://hub.docker.com/_/mysql/)
- [PostgreSQL](https://hub.docker.com/_/postgres/)
- [MongoDB](https://hub.docker.com/_/mongo/)
- [Cassandra](https://hub.docker.com/_/cassandra/)
- [Elasticsearch](https://hub.docker.com/_/elasticsearch/)



## Installation

As this is a [JHipster](http://jhipster.github.io/) module, we expect you have JHipster and its related tools already installed.

```bash
npm install -g generator-jhipster-docker
```

Then run the module on a JHipster generated application:

```bash
yo jhipster-docker
```



## Usage

### 1 - Generate docker-compose services

#### 1.1 - Description

When using `generating docker-compose services`, if your project uses MySQL, PostgreSQL, MongoDB or Cassandra, a `docker-compose.yml` or `docker-compose-prod.yml` file is generated in your folder project.

If your project uses Elasticsearch as search engine, the configuration will be included in `docker-compose-prod.yml`.

So you can use docker-compose to start your database in development or production profile.



#### 1.2 - Working with databases

##### Starting MySQL, PostgreSQL or MongoDB

In development profile:

`docker-compose up -d`

In production profile (it will start Elasticsearch too if you selected it as search engine):

`docker-compose -f docker-compose-prod.yml up -d`

##### Starting Cassandra the first time

In development profile:

- Build the image, which will contain the CQL scripts generated by your project for initializing the database: `docker-compose build`
- Start the container (it will show the container id): `docker-compose up -d`
- Initialize the database by creating the Keyspace and the Tables: `docker exec -it "container id" init`

In production profile:

- Build the image: `docker-compose -f docker-compose-prod.yml build`
- Start the container (it will show the container id): `docker-compose -f docker-compose-prod.yml up -d`
- Initialize the database by creating the Keyspace and the Tables: `docker exec -it "container id" init`

##### Starting Cassandra the next times

In development profile:

`docker-compose up -d`

In production profile:

`docker-compose -f docker-compose-prod.yml up -d`

#### 1.3 - Common commands

##### List the containers

You can use `docker ps -a` to list all the containers

    $ docker ps -a
    CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
    fc35e1090021        mysql               "/entrypoint.sh mysql"   4 seconds ago       Up 4 seconds        0.0.0.0:3306->3306/tcp   sampleApplication-prod-mysql


##### Stop the containers

In development profile:

`docker-compose stop`

In production profile:

`docker-compose -f docker-compose-prod.yml stop`

You can use directly docker: `docker stop "container id"`

When you stop a container, the data are not deleted, unless you delete the container.

##### Delete a container

Be carefull! All data will be deleted:

`docker rm "container id"`



### 2 - Automated build at https://hub.docker.com



### 3 - Local build and push image to https://hub.docker.com/



## License

Apache-2.0 Â© [Pascal Grimaud](https://twitter.com/pascalgrimaud)

[npm-image]: https://img.shields.io/npm/v/generator-jhipster-docker.svg
[npm-url]: https://npmjs.org/package/generator-jhipster-docker
[travis-image]: https://travis-ci.org/pascalgrimaud/generator-jhipster-docker.svg?branch=master
[travis-url]: https://travis-ci.org/pascalgrimaud/generator-jhipster-docker
[daviddm-image]: https://david-dm.org/pascalgrimaud/generator-jhipster-docker.svg?theme=shields.io
[daviddm-url]: https://david-dm.org/pascalgrimaud/generator-jhipster-docker
